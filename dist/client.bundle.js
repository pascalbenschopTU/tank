(()=>{var t={717:(t,e,s)=>{const i=s(957);s(78);class n{constructor(t,e,s){this.context=t,this.images=e,this.viewport=s,this.width=t.canvas.width,this.height=t.canvas.height}static create(t,e){const s=t.getContext("2d");return new n(s,{},e)}clear(){this.context.clearRect(0,0,this.width,this.height)}drawTank(t,e){var s=i.DRAWING_ENEMY_COLOUR;t&&(s=i.DRAWING_SELF_COLOUR),"bot"==e.name&&(s=i.DRAWING_BOT_COLOUR),this.drawTankSkeleton(e,s),this.drawTurret(e,s)}loadBulletImage(){var t=new Image;return t.src=i.DRAWING_BULLET_PATH,t}drawBullet(t){this.context.save(),this.context.translate(t.position.x,t.position.y),this.context.rotate(t.angle+Math.PI/2),this.context.drawImage(this.loadBulletImage(),-7,0,15,25),this.context.rotate(-t.angle+Math.PI/2),this.context.translate(-t.position.x,t.position.y),this.context.restore()}drawWall(t){this.context.save(),this.context.fillStyle="green",this.context.fillRect(t.minX,t.minY,t.width,t.height),this.context.restore()}getTankSkeletonPolygon(t){var e=Math.atan(23/31),s=Math.sqrt(1490)/2,i=t.tankAngle-e,n=t.tankAngle+e;return{x:t.position.x,y:t.position.y,points:[{x:Math.cos(i)*s,y:Math.sin(i)*s},{x:Math.cos(n)*s,y:Math.sin(n)*s},{x:Math.cos(i+Math.PI)*s,y:Math.sin(i+Math.PI)*s},{x:Math.cos(n+Math.PI)*s,y:Math.sin(n+Math.PI)*s}]}}drawTankSkeleton(t,e){this.context.save();var s=this.getTankSkeletonPolygon(t);this.context.beginPath();for(var i=0,n=s.points.length;i<n;i++)(0===i?this.context.moveTo:this.context.lineTo).call(this.context,s.x+s.points[i].x,s.y+s.points[i].y);this.context.closePath(),this.context.strokeStyle="#000",this.context.fillStyle=e,this.context.stroke(),this.context.fill(),this.context.restore()}drawTurret(t,e){var s=t.turretAngle,i=Math.asin(3.5/8),n=Math.atan(3.5/23),o=s+i,a=s+2*Math.PI-i;this.context.beginPath(),this.context.arc(t.position.x,t.position.y,8,o,a,!1),this.context.lineTo(t.position.x+23*Math.cos(s-n),t.position.y+23*Math.sin(s-n)),this.context.lineTo(t.position.x+23*Math.cos(s+n),t.position.y+23*Math.sin(s+n)),this.context.closePath(),this.context.strokeStyle="#000",this.context.fillStyle=e,this.context.stroke(),this.context.fill()}}t.exports=n},893:(t,e,s)=>{const i=s(717),n=s(144),o=s(681),a=s(957),h=s(38),r=s(78);class c{constructor(t,e,s,i){this.socket=t,this.viewport=e,this.drawing=s,this.input=i,this.self=null,this.players=[],this.projectiles=[],this.walls=[],this.animationFrameId=null,this.lastUpdateTime=0,this.deltaTime=0}static create(t,e){const s=document.getElementById(e);s.width=a.CANVAS_WIDTH,s.height=a.CANVAS_HEIGHT;const h=o.create(s),r=i.create(s,h),l=n.create(document,s),d=new c(t,h,r,l);return d.init(),d}init(){this.lastUpdateTime=Date.now(),this.socket.on(a.SOCKET_UPDATE,this.onReceiveGameState.bind(this)),this.socket.on(a.SOCKET_MAP_UPDATE,this.onReceiveGameMap.bind(this))}onReceiveGameState(t){this.self=t.self,this.players=t.players,this.projectiles=t.projectiles}onReceiveGameMap(t){this.walls=t.walls}run(){const t=Date.now();this.deltaTime=t-this.lastUpdateTime,this.lastUpdateTime=t,this.update(),this.draw(),this.animationFrameId=window.requestAnimationFrame(this.run.bind(this))}stop(){window.cancelAnimationFrame(this.animationFrameId)}reset(){this.socket.emit(a.SOCKET_RESET,{})}update(){if(this.self){const t=this.viewport.toCanvas(h.fromArray(this.input.mouseCoords)),e=h.sub(t,this.self.position);this.socket.emit(a.SOCKET_PLAYER_ACTION,{up:this.input.up,down:this.input.down,left:this.input.left,right:this.input.right,shoot:this.input.mouseDown,turretAngle:r.normalizeAngle(e.angle)})}}draw(){this.self&&(this.drawing.clear(),this.projectiles.forEach(this.drawing.drawBullet.bind(this.drawing)),this.players.forEach((t=>this.drawing.drawTank(!1,t))),this.drawing.drawTank(!0,this.self),this.walls.forEach((t=>this.drawing.drawWall(t))))}}t.exports=c},144:t=>{class e{constructor(){this.up=!1,this.down=!1,this.left=!1,this.right=!1,this.mouseDown=!1,this.mouseCoords=[0,0]}static create(t,s){const i=new e;return i.applyEventHandlers(t,t,s),i}onKeyDown(t){switch(t.keyCode){case 37:case 65:case 97:this.left=!0;break;case 38:case 87:case 199:this.up=!0;break;case 39:case 68:case 100:this.right=!0;break;case 40:case 83:case 115:this.down=!0}}onKeyUp(t){switch(t.keyCode){case 37:case 65:case 97:this.left=!1;break;case 38:case 87:case 199:this.up=!1;break;case 39:case 68:case 100:this.right=!1;break;case 40:case 83:case 115:this.down=!1}}onMouseDown(t){1===t.which&&(this.mouseDown=!0)}onMouseUp(t){1===t.which&&(this.mouseDown=!1)}onMouseMove(t){this.mouseCoords=[t.clientX,t.clientY]}applyEventHandlers(t,e,s){t.addEventListener("keydown",this.onKeyDown.bind(this)),t.addEventListener("keyup",this.onKeyUp.bind(this)),e.addEventListener("mousedown",this.onMouseDown.bind(this)),e.addEventListener("mouseup",this.onMouseUp.bind(this)),s.setAttribute("tabindex",1),s.addEventListener("mousemove",this.onMouseMove.bind(this))}}t.exports=e},681:(t,e,s)=>{s(957),s(73);const i=s(38);class n{constructor(t,e,s){this.canvasOffset=new i(e/2,s/2),this.position=t}static create(t){var e=t.getBoundingClientRect();return new n(new i(e.left,e.top),t.width,t.height)}toCanvas(t){return i.sub(t,this.position)}}t.exports=n},957:t=>{t.exports={PORT:25565,CANVAS_WIDTH:1200,CANVAS_HEIGHT:800,DRAWING_BULLET_PATH:"client/images/bullet3.0.png",DRAWING_ENEMY_COLOUR:"#00FF00",DRAWING_BOT_COLOUR:"#FF0000",DRAWING_SELF_COLOUR:"#FFFF00",SOCKET_UPDATE:"update",SOCKET_RESET:"reset",SOCKET_MAP_UPDATE:"map-update",SOCKET_NEW_PLAYER:"new-player",SOCKET_PLAYER_ACTION:"player-action",SOCKET_CHAT_CLIENT_SERVER:"chat-client-to-server",SOCKET_CHAT_SERVER_CLIENT:"chat-server-to-client",SOCKET_DISCONNECT:"disconnect",PLAYER_TURN_RATE:.005,PLAYER_DEFAULT_SPEED:.2,PLAYER_SHOT_COOLDOWN:200,PLAYER_DEFAULT_HITBOX_SIZE:20,PLAYER_SHIELD_HITBOX_SIZE:45,PLAYER_MAX_HEALTH:10,BOT_SHOT_COOLDOWN:2e3,BOT_DEFAULT_SPEED:.1,BULLET_DEFAULT_DAMAGE:1,BULLET_SPEED:.4,BULLET_HITBOX_SIZE:5}},73:(t,e,s)=>{const i=s(957),n=s(78),o=s(38);t.exports=class{constructor(t,e,s){this.position=t||o.zero(),this.velocity=e||o.zero(),this.hitboxSize=s}collided(t){const e=this.hitboxSize+t.hitboxSize;return o.sub(this.position,t.position).mag2<=e*e}collidedAt(t,e){const s=this.hitboxSize+t.hitboxSize;return o.sub(this.position,e).mag2<=s*s}inWorld(){return n.inBound(this.position.x,0,i.CANVAS_WIDTH)&&n.inBound(this.position.y,0,i.CANVAS_HEIGHT)}boundToWorld(){this.position.x=n.bound(this.position.x,10,i.CANVAS_WIDTH-10),this.position.y=n.bound(this.position.y,10,i.CANVAS_HEIGHT-10)}}},78:t=>{const e=(t,e)=>t>e?Math.floor(Math.random()*(t-e))+e:Math.floor(Math.random()*(e-t))+t;t.exports={normalizeAngle:t=>t-2*Math.PI*Math.floor((t+Math.PI)/(2*Math.PI)),inBound:(t,e,s)=>e>s?t>=s&&t<=e:t>=e&&t<=s,bound:(t,e,s)=>e>s?Math.min(Math.max(t,s),e):Math.min(Math.max(t,e),s),reverseBound:(t,e,s,i)=>e<=s&&t>s?s:e>=i&&t<i?i:t,reverseBounce:(t,e,s,i)=>e<s&&t>s||e>i&&t<i,randRange:(t,e)=>t>=e?Math.random()*(t-e)+e:Math.random()*(e-t)+t,randRangeInt:e,choiceArray:t=>t[e(0,t.length)]}},38:t=>{class e{constructor(t=0,e=0){this.x=t,this.y=e}static fromArray(t){return new e(t[0],t[1])}static fromObject(t){return new e(t.x,t.y)}static fromPolar(t,s){return new e(t*Math.cos(s),t*Math.sin(s))}static one(){return new e(1,1)}static zero(){return new e(0,0)}get angle(){return Math.atan2(this.y,this.x)}get mag(){return Math.sqrt(this.mag2)}get mag2(){return this.x*this.x+this.y*this.y}get neg(){return new e(-this.x,-this.y)}get normalize(){return new e(this.x/this.mag,this.y/this.mag)}get asArray(){return[this.x,this.y]}static add(t,s){return new e(t.x+s.x,t.y+s.y)}static divide(t,s){return new e(t.x/s.x,t.y/s.y)}static scale(t,s){return new e(t.x*s,t.y*s)}static sub(t,s){return new e(t.x-s.x,t.y-s.y)}add(t){return this.x+=t.x,this.y+=t.y,this}copy(){return new e(this.x,this.y)}distance(t){var e=this.x-t.x,s=this.y-t.y;return Math.sqrt(Math.pow(e,2)+Math.pow(s,2))}dot(t){return this.x*t.x+this.y*t.y}scale(t){return this.x*=t,this.y*=t,this}sub(t){return this.x-=t.x,this.y-=t.y,this}angleWith(t){return this.dot(t)/(this.mag*t.mag)}}t.exports=e}},e={};function s(i){var n=e[i];if(void 0!==n)return n.exports;var o=e[i]={exports:{}};return t[i](o,o.exports,s),o.exports}(()=>{const t=io(),e=s(893).create(t,"canvas");t.emit("new-player"),e.run(),document.getElementById("reset-button").onclick=function(){e.reset()}})()})();
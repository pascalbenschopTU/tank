(()=>{var t={309:(t,e,s)=>{const i=s(957),n=(s(106),["set_level","toggleLearning"]),o="#00FF00",a="Command",r="autocomplete-list",h="autocomplete-items",c="autocomplete-active";class l{constructor(t,e,s){this.console=t,this.textbox=e,this.socket=s,this.focusOnKeyPress(),this.receiveMessages(),this.writeInputToConsole(),this.autocomplete(t,n)}static create(t,e,s){return new l(t,e,s)}focusOnKeyPress(){document.addEventListener("keydown",(t=>{document.getElementById("splashscreen").classList.contains("hidden")&&"t"==t.key&&document.getElementById("console").focus()}))}writeInputToConsole(){this.console.addEventListener("keyup",(t=>{"Enter"==t.key&&(this.processInput(t.target.value),this.console.value="")}))}processInput(t){let e=t.split(" "),s={};if(e.length>0)switch(e[0]){case n[0]:this.textbox.addListItem(t,a,o);let i=parseInt(e[1]);isNaN(i)?this.textbox.addListItem("Please provide a number","Error","#FF0000"):s.level=i;break;case n[1]:this.textbox.addListItem(t,a,o),s.toggleTraining=!0;break;default:s.socket_id=this.socket.id,s.message=t,this.sendMessages(s)}this.sendDebugInfo(s)}receiveMessages(){this.socket.on(i.SOCKET_MESSAGE,(t=>{this.textbox.addListItem(t.message,"Message","#FFFFFF")}))}sendMessages(t){this.socket.emit(i.SOCKET_MESSAGE,t)}sendDebugInfo(t){this.socket.emit(i.SOCKET_DEBUG_INFO,t)}autocomplete(t,e){var s;function i(t){if(!t)return!1;!function(t){for(var e=0;e<t.length;e++)t[e].classList.remove(c)}(t),s>=t.length&&(s=0),s<0&&(s=t.length-1),t[s].classList.add(c)}function n(e){for(var s=document.getElementsByClassName(h),i=0;i<s.length;i++)e!=s[i]&&e!=t&&s[i].parentNode.removeChild(s[i])}t.addEventListener("input",(function(i){var o,a,c,l=i.target.value;if(n(),!l)return!1;for(s=-1,(o=document.createElement("DIV")).setAttribute("id",t.id+r),o.setAttribute("class",h),t.parentNode.appendChild(o),c=0;c<e.length;c++)e[c].substr(0,l.length).toUpperCase()==l.toUpperCase()&&((a=document.createElement("DIV")).innerHTML="<strong>"+e[c].substr(0,l.length)+"</strong>",a.innerHTML+=e[c].substr(l.length),a.innerHTML+="<input type='hidden' value='"+e[c]+"'>",a.addEventListener("click",(function(e){t.value=e.target.getElementsByTagName("input")[0].value,n()})),o.appendChild(a))})),t.addEventListener("keydown",(function(e){var o=document.getElementById(t.id+r);o&&(o=o.getElementsByTagName("div")),"ArrowDown"==e.key?(s++,i(o)):"ArrowUp"==e.key?(s--,i(o)):"Tab"==e.key?(e.preventDefault(),s>-1&&o&&(t.value=o[s].getElementsByTagName("input")[0].value)):"Enter"==e.key&&n(o)})),document.addEventListener("click",(function(t){n(t.target)}))}}t.exports=l},717:(t,e,s)=>{const i=s(957);s(78);class n{constructor(t,e,s){this.context=t,this.images=e,this.viewport=s,this.width=t.canvas.width,this.height=t.canvas.height}static create(t,e){const s=t.getContext("2d");return new n(s,{},e)}clear(){this.context.clearRect(0,0,this.width,this.height)}drawTank(t,e){var s=i.DRAWING_ENEMY_COLOUR;t&&(s=i.DRAWING_SELF_COLOUR),"bot"==e.name&&(s=i.DRAWING_BOT_COLOUR),this.drawTankSkeleton(e,s,23,31),this.drawTurret(e,s,7,8,15)}loadBulletImage(){var t=new Image;return t.src=i.DRAWING_BULLET_PATH,t}drawBullet(t,e,s){this.context.save(),this.context.translate(t.position.x,t.position.y),this.context.rotate(t.angle+Math.PI/2),this.context.drawImage(this.loadBulletImage(),-7,0,e,s),this.context.rotate(-t.angle+Math.PI/2),this.context.translate(-t.position.x,t.position.y),this.context.restore()}drawWall(t){this.context.save(),this.context.fillStyle="green",this.context.fillRect(t.minX,t.minY,t.width,t.height),this.context.restore()}getTankSkeletonPolygon(t,e,s){var i=Math.atan(e/s),n=Math.sqrt(s*s+e*e)/2,o=t.tankAngle-i,a=t.tankAngle+i;return{x:t.position.x,y:t.position.y,points:[{x:Math.cos(o)*n,y:Math.sin(o)*n},{x:Math.cos(a)*n,y:Math.sin(a)*n},{x:Math.cos(o+Math.PI)*n,y:Math.sin(o+Math.PI)*n},{x:Math.cos(a+Math.PI)*n,y:Math.sin(a+Math.PI)*n}]}}drawTankSkeleton(t,e,s,i){this.context.save();var n=this.getTankSkeletonPolygon(t,s,i);this.context.beginPath();for(var o=0,a=n.points.length;o<a;o++)(0===o?this.context.moveTo:this.context.lineTo).call(this.context,n.x+n.points[o].x,n.y+n.points[o].y);this.context.closePath(),this.context.strokeStyle="#000",this.context.fillStyle=e,this.context.stroke(),this.context.fill(),this.context.restore()}drawTurret(t,e,s,i,n){var o=t.turretAngle,a=Math.asin(s/2/i),r=Math.atan(s/2/(i+n)),h=o+a,c=o+2*Math.PI-a;this.context.beginPath(),this.context.arc(t.position.x,t.position.y,i,h,c,!1),this.context.lineTo(t.position.x+(i+n)*Math.cos(o-r),t.position.y+(i+n)*Math.sin(o-r)),this.context.lineTo(t.position.x+(i+n)*Math.cos(o+r),t.position.y+(i+n)*Math.sin(o+r)),this.context.closePath(),this.context.strokeStyle="#000",this.context.fillStyle=e,this.context.stroke(),this.context.fill()}}t.exports=n},893:(t,e,s)=>{const i=s(717),n=s(144),o=s(309),a=s(681),r=s(957),h=s(38),c=s(78),l=s(106);class d{constructor(t,e,s,i,n,o){this.socket=t,this.viewport=e,this.drawing=s,this.input=i,this.textbox=n,this.console=o,this.self=null,this.players=[],this.projectiles=[],this.walls=[],this.animationFrameId=null,this.lastUpdateTime=0,this.deltaTime=0}static create(t,e,s,h){const c=document.getElementById(e);c.width=r.CANVAS_WIDTH,c.height=r.CANVAS_HEIGHT;const u=a.create(c),m=i.create(c,u),p=n.create(document,c),E=l.create(document.getElementById(s)),x=o.create(document.getElementById(h),E,t),g=new d(t,u,m,p,E,x);return g.init(),g}init(){this.lastUpdateTime=Date.now(),this.socket.on(r.SOCKET_UPDATE,this.onReceiveGameState.bind(this)),this.socket.on(r.SOCKET_MAP_UPDATE,this.onReceiveGameMap.bind(this))}onReceiveGameState(t){this.self=t.self,this.players=t.players,this.projectiles=t.projectiles}onReceiveGameMap(t){this.walls=t.walls}run(){const t=Date.now();this.deltaTime=t-this.lastUpdateTime,this.lastUpdateTime=t,this.update(),this.draw(),this.animationFrameId=window.requestAnimationFrame(this.run.bind(this))}stop(){window.cancelAnimationFrame(this.animationFrameId)}reset(){this.socket.emit(r.SOCKET_RESET,{})}update(){if(this.self){const t=this.viewport.toCanvas(h.fromArray(this.input.mouseCoords)),e=h.sub(t,this.self.position);document.getElementById("console")!==document.activeElement&&this.socket.emit(r.SOCKET_PLAYER_ACTION,{up:this.input.up,down:this.input.down,left:this.input.left,right:this.input.right,shoot:this.input.mouseDown,turretAngle:c.normalizeAngle(e.angle)})}}draw(){this.self&&(this.drawing.clear(),this.projectiles.forEach((t=>this.drawing.drawBullet(t,15,25))),this.players.forEach((t=>this.drawing.drawTank(!1,t))),this.drawing.drawTank(!0,this.self),this.walls.forEach((t=>this.drawing.drawWall(t))))}}t.exports=d},144:t=>{class e{constructor(){this.up=!1,this.down=!1,this.left=!1,this.right=!1,this.mouseDown=!1,this.mouseCoords=[0,0]}static create(t,s){const i=new e;return i.applyEventHandlers(t,s,s),i}onKeyDown(t){switch(t.keyCode){case 37:case 65:case 97:this.left=!0;break;case 38:case 87:case 199:this.up=!0;break;case 39:case 68:case 100:this.right=!0;break;case 40:case 83:case 115:this.down=!0}}onKeyUp(t){switch(t.keyCode){case 37:case 65:case 97:this.left=!1;break;case 38:case 87:case 199:this.up=!1;break;case 39:case 68:case 100:this.right=!1;break;case 40:case 83:case 115:this.down=!1}}onMouseDown(t){1===t.which&&(this.mouseDown=!0)}onMouseUp(t){1===t.which&&(this.mouseDown=!1)}onMouseMove(t){this.mouseCoords=[t.clientX,t.clientY]}applyEventHandlers(t,e,s){t.addEventListener("keydown",this.onKeyDown.bind(this)),t.addEventListener("keyup",this.onKeyUp.bind(this)),e.addEventListener("mousedown",this.onMouseDown.bind(this)),e.addEventListener("mouseup",this.onMouseUp.bind(this)),s.setAttribute("tabindex",1),s.addEventListener("mousemove",this.onMouseMove.bind(this))}}t.exports=e},106:t=>{class e{constructor(t){this.container=t}static create(t){return new e(t)}addListItem(t,e,s){const i=document.createElement("li");i.appendChild(document.createTextNode(t)),i.id=e,i.style.color=s,this.container.appendChild(i)}update(t){let e=this.container.children.length;for(let t=0;t<e;t++){let e=this.container.children[t];e&&"Console"!=e.id&&this.container.removeChild(e)}t.sort(((t,e)=>e.kills-t.kills)),t.slice(0,10).forEach((t=>{this.addListItem(`${t.name} - Kills: ${t.kills} Deaths: ${t.deaths}`,"scoreboard")}))}}t.exports=e},681:(t,e,s)=>{s(957),s(73);const i=s(38);class n{constructor(t,e,s){this.canvasOffset=new i(e/2,s/2),this.position=t}static create(t){var e=t.getBoundingClientRect();return new n(new i(e.left,e.top),t.width,t.height)}toCanvas(t){return i.sub(t,this.position)}}t.exports=n},957:t=>{t.exports={PORT:5e3,CANVAS_WIDTH:1200,CANVAS_HEIGHT:700,DRAWING_BULLET_PATH:"client/images/bullet3.0.png",DRAWING_ENEMY_COLOUR:"#00FF00",DRAWING_BOT_COLOUR:"#FF0000",DRAWING_SELF_COLOUR:"#FFFF00",SOCKET_UPDATE:"update",SOCKET_RESET:"reset",SOCKET_MAP_UPDATE:"map-update",SOCKET_NEW_PLAYER:"new-player",SOCKET_PLAYER_ACTION:"player-action",SOCKET_DEBUG_INFO:"debug-info",SOCKET_MESSAGE:"message",SOCKET_DISCONNECT:"disconnect",PLAYER_TURN_RATE:.005,PLAYER_DEFAULT_SPEED:.2,PLAYER_SHOT_COOLDOWN:200,PLAYER_DEFAULT_HITBOX_SIZE:20,PLAYER_SHIELD_HITBOX_SIZE:45,PLAYER_MAX_HEALTH:10,PLAYER_NAME:"player",Player_UPDATE_RATE:1/60,BOT_SHOT_COOLDOWN:400,BOT_DEFAULT_SPEED:.1,BOT_NAME:"bot",BOT_UPDATE_RATE:.05,BULLET_DEFAULT_DAMAGE:1,BULLET_SPEED:.4,BULLET_HITBOX_SIZE:5}},73:(t,e,s)=>{const i=s(957),n=s(78),o=s(38);t.exports=class{constructor(t,e,s){this.position=t||o.zero(),this.velocity=e||o.zero(),this.hitboxSize=s}collided(t){const e=this.hitboxSize+t.hitboxSize;return o.sub(this.position,t.position).mag2<=e*e}collidedAt(t,e){const s=this.hitboxSize+t.hitboxSize;return o.sub(this.position,e).mag2<=s*s}inWorld(){return n.inBound(this.position.x,0,i.CANVAS_WIDTH)&&n.inBound(this.position.y,0,i.CANVAS_HEIGHT)}boundToWorld(){this.position.x=n.bound(this.position.x,10,i.CANVAS_WIDTH-10),this.position.y=n.bound(this.position.y,10,i.CANVAS_HEIGHT-10)}}},78:t=>{const e=(t,e)=>t>e?Math.floor(Math.random()*(t-e))+e:Math.floor(Math.random()*(e-t))+t;t.exports={normalizeAngle:t=>t-2*Math.PI*Math.floor((t+Math.PI)/(2*Math.PI)),inBound:(t,e,s)=>e>s?t>=s&&t<=e:t>=e&&t<=s,bound:(t,e,s)=>e>s?Math.min(Math.max(t,s),e):Math.min(Math.max(t,e),s),reverseBound:(t,e,s,i)=>e<=s&&t>s?s:e>=i&&t<i?i:t,reverseBounce:(t,e,s,i)=>e<s&&t>s||e>i&&t<i,randRange:(t,e)=>t>=e?Math.random()*(t-e)+e:Math.random()*(e-t)+t,randRangeInt:e,choiceArray:t=>t[e(0,t.length)],sum:t=>(total=0,t.forEach((t=>total+=t)),total),argmax:t=>{index=0,max=-1/0;for(var e=0;e<t.length;e++)t[e]>max&&(max=t[e],index=e);return index}}},38:t=>{class e{constructor(t=0,e=0){this.x=t,this.y=e}static fromArray(t){return new e(t[0],t[1])}static fromObject(t){return new e(t.x,t.y)}static fromPolar(t,s){return new e(t*Math.cos(s),t*Math.sin(s))}static one(){return new e(1,1)}static zero(){return new e(0,0)}get isZero(){return 0==this.x&&0==this.y}get angle(){return Math.atan2(this.y,this.x)}get mag(){return Math.sqrt(this.mag2)}get mag2(){return this.x*this.x+this.y*this.y}get product(){return this.x*this.y}get neg(){return new e(-this.x,-this.y)}get normalize(){return new e(this.x/this.mag,this.y/this.mag)}get asArray(){return[this.x,this.y]}static add(t,s){return new e(t.x+s.x,t.y+s.y)}static divide(t,s){return new e(t.x/s.x,t.y/s.y)}static scale(t,s){return new e(t.x*s,t.y*s)}static sub(t,s){return new e(t.x-s.x,t.y-s.y)}add(t){return this.x+=t.x,this.y+=t.y,this}copy(){return new e(this.x,this.y)}distance(t){var e=this.x-t.x,s=this.y-t.y;return Math.sqrt(Math.pow(e,2)+Math.pow(s,2))}dot(t){return this.x*t.x+this.y*t.y}scale(t){return this.x*=t,this.y*=t,this}sub(t){return this.x-=t.x,this.y-=t.y,this}angleWith(t){return this.dot(t)/(this.mag*t.mag)}}t.exports=e}},e={};function s(i){var n=e[i];if(void 0!==n)return n.exports;var o=e[i]={exports:{}};return t[i](o,o.exports,s),o.exports}(()=>{const t=io(),e=s(957),i=s(893).create(t,"canvas","textbox","console");document.getElementById("splashscreen-input").focus();var n=document.getElementById("splashscreen");n.addEventListener("keyup",(s=>{"Enter"==s.key&&(n.style.opacity=0,setTimeout((()=>{n.classList.add("hidden")}),210),t.emit(e.SOCKET_NEW_PLAYER,s.target.value),i.run())})),document.getElementById("reset-button").onclick=function(){i.reset()}})()})();